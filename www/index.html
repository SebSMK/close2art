<!DOCTYPE html>
<html>
  <head>
    <title>Capture Photo</title>
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1"/>        
    
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/jquery.mmenu.all.css">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/audioplayer.css">
    <link rel="stylesheet" href="css/smk.css">
    
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>    
    <script src="js/openseadragon.js"></script>
    
    
    <script src="js/openseadragonselection.js"></script> 
        
    <script src="js/app.js"></script>  
    
    <script src="https://unpkg.com/masonry-layout@4.1/dist/masonry.pkgd.min.js"></script>
    <script src="http://imagesloaded.desandro.com/imagesloaded.pkgd.js"></script>            
    
    <style>
      * { box-sizing: border-box; }

      body { font-family: sans-serif; }
      
      .grid {
        background-color: rgba(255,255,255,0.3);
        width: 200px;
        display: block;
        position: absolute;
        top: 70px;
        z-index: 100;           
      }
      
      .grid-item {
        float: left;
        margin-bottom: 10px;
      }
      
      /* item is invisible, but used for layout */
      .grid-item,
      .grid-item-content {
        width: 200px;
        //height: 120px;
      }
      
      /* grid-item-content is visible, and transitions size */
      .grid-item-content {
        width: 200px;        
        border: 4px solid #333;
        border-color: rgba(255,255,255,0.5);
        border-radius: 5px;
        -webkit-transition: width 0.4s, height 0.4s;
                transition: width 0.4s, height 0.4s;
      }
      
      .grid-item:hover .grid-item-content {
        border-color: white;
        background: #A2C;
        cursor: pointer;
      }
      
      /* both item and item content change size */
      .grid-item.is-expanded,
      .grid-item.is-expanded .grid-item-content {
        width: 360px;
        height: 240px;
      }
      
      .grid.is-expanded{
        width: 1200px;  
      }
      
      .grid-item.is-expanded {
        z-index: 2;
      }
      
      .grid-item.is-expanded .grid-item-content {
        background: #F90;
      }
    
    </style>      
    
  </head>
  <body>        
    
    <section id="command" style="display">
      <button onclick="displayImage();addNewImages();">Start viewer</button> <br> 
      <button onclick="ocrAPI();">SMK OCR</button> <br>         
      <button onclick="capturePhotoWithData();">Capture Photo With Image Data</button> <br>    
      <button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">From Photo Library</button><br>
      <div id="output"></div>          
    </section>
    
    <section id="display" style="display:none">            
      
      <div class="wrapper object mm-page mm-slideout">
        <div id="ocr" class="fa fa-camera"><a title="Recognize artwork" onclick="displayImage();">Recognize artwork</a></div>
        <div id="view-toggle" class="fa fa-bars"><a title="Toggle view" href="#menu">Toggle view</a></div>      

        <div id="mini" class="fa fa-bars"><a title="Show menu" href="#menu">Show menu</a></div>      
        <div class="transLogo light" style="display: block;">
           <div id="title" class="headerLink"><img class="logo" src="/img/SMK-logo-w.png" alt="SMK"></div>
        </div>      
        <div id="dz" class="fullImg" style="height: 1024px; max-height: 1024px;">
          <div id="zoomCtrls">
            <div id="crop-toggle" class="zoom-icon fa fa-scissors" title="Crop toggle"></div>
            <div id="zoom-in" class="zoom-icon fa fa-plus" title="Zoom in"></div>            
            <div id="zoom-out" class="zoom-icon fa fa-minus" title="Zoom out"></div>
          </div>
        </div>              
      </div>
      <div id="grid" class="grid"></div>
      
      <div id="image-container"></div>  
    </section>
    
   
    
    <script src="js/imgReveal.js"></script>    
    <script type="text/javascript">                           
            
      //var grid = document.getElementById('grid');//document.querySelector('.grid');
      
      var $container = $('#grid').masonry({
        columnWidth: 200,
        itemSelector: '.grid-item',
        containerStyle: { position: 'absolute' }, 
        gutter: 10
      }); 
      /*
      var msnry = new Masonry( grid, {
        columnWidth: 200,
        itemSelector: '.grid-item',
        containerStyle: { position: 'absolute' }, 
        gutter: 10        
      });
      */ 
      
      var getItem = function() {  
        var rando = Math.ceil( Math.random() * 1000 );
        // random parameter to prevent cached images
        var src = "http://demoapi.smk.dk:8088/api/images/rand/" + rando + "?size=medium";
        
        var aEl  = document.createElement("div"); 
        aEl.setAttribute("class", "grid-item");                   
        var img = document.createElement("img");
        img.setAttribute("class", "grid-item-content");
        img.setAttribute("src", src);            
        aEl.appendChild(img);                     
        
        var item = aEl.outerHTML;
        return item;
      };
      
      var getItems = function() {
        var items = '';
        for ( var i=0; i < 3; i++ ) {
          items += getItem();
        }
        // return jQuery object
        return $( items );
      }
      
      var addNewImages = function(){
        var $items = getItems();
        $container.masonryImagesReveal( $items );      
      };
                  
      grid.addEventListener( 'click', function( event ) {
        // don't proceed if item content was not clicked on
        if ( !matchesSelector( event.target, '.grid-item-content' )  ) {
          return;
        }
        //var itemElem = event.target.parentNode;
        //itemElem.classList.toggle('is-expanded');
        grid.classList.toggle('is-expanded');
      
        $container.masonry('layout');
      });
     
     
     
    </script>
       
  </body>
</html>



